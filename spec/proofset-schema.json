{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://windi.systems/schemas/proofset/v1",
  "title": "WINDI ProofSet Schema",
  "description": "Cryptographic proof container for document integrity verification",
  "type": "object",
  "required": ["version", "document_hash", "proof_shelves", "created_at"],
  "properties": {
    "version": {
      "type": "string",
      "const": "1.0",
      "description": "ProofSet schema version"
    },
    "document_id": {
      "type": "string",
      "pattern": "^windi:doc:[a-zA-Z0-9_-]+$",
      "description": "WINDI document identifier (URN format)"
    },
    "document_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA-256 hash of the complete document in URN format"
    },
    "proof_shelves": {
      "type": "object",
      "description": "Collection of field-level proof hashes",
      "properties": {
        "payto_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$",
          "description": "Hash of canonicalized PAYTO shelf"
        },
        "amount_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$",
          "description": "Hash of canonicalized AMOUNT shelf"
        },
        "currency_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$",
          "description": "Hash of canonicalized CURRENCY shelf"
        },
        "date_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$",
          "description": "Hash of canonicalized DATE shelf"
        },
        "structure_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$",
          "description": "Hash of document structure metadata"
        }
      },
      "additionalProperties": {
        "type": "string",
        "pattern": "^sha256:[a-f0-9]{64}$"
      }
    },
    "issuer_key_id": {
      "type": "string",
      "pattern": "^windi:key:[a-zA-Z0-9_-]+$",
      "description": "Issuer's public key identifier"
    },
    "signature": {
      "type": "string",
      "description": "Ed25519 signature over the ProofSet (base64)"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of proof creation"
    },
    "expires_at": {
      "type": "string",
      "format": "date-time",
      "description": "Optional expiration timestamp"
    },
    "manifest_id": {
      "type": "string",
      "pattern": "^windi:manifest:[a-zA-Z0-9_-]+$",
      "description": "Reference to document manifest/template"
    },
    "metadata": {
      "type": "object",
      "description": "Optional metadata (non-hashed)",
      "properties": {
        "issuer_name": { "type": "string" },
        "document_type": { "type": "string" },
        "jurisdiction": { "type": "string" }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
